---
- name: 验证集群状态（Ubuntu专用）
  hosts: kubernetes_first_master
  become: yes
  vars_files:
    - ../../group_vars/all.yml
  tasks:
    - name: 获取节点状态
      shell: kubectl get nodes -o wide
      register: nodes_status
      environment:
        KUBECONFIG: /etc/kubernetes/admin.conf

    - name: 显示节点状态
      debug:
        var: nodes_status.stdout_lines

    - name: 获取所有 pods 状态
      shell: kubectl get pods -A
      register: pods_status
      environment:
        KUBECONFIG: /etc/kubernetes/admin.conf

    - name: 显示 pods 状态
      debug:
        var: pods_status.stdout_lines

    - name: 检查集群信息
      shell: kubectl cluster-info
      register: cluster_info
      environment:
        KUBECONFIG: /etc/kubernetes/admin.conf

    - name: 显示集群信息
      debug:
        var: cluster_info.stdout_lines
